%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#3b82f6', 'secondaryColor': '#10b981', 'tertiaryColor': '#f59e0b'}}}%%

flowchart TB
    subgraph System["ðŸ›ï¸ Vietnamese Tax Law Explorer System"]
        UC1([ðŸ“ Query Legal Documents])
        UC2([ðŸ” Search by Keywords])
        UC3([ðŸ—ºï¸ Explore Knowledge Graph])
        UC4([ðŸ“Š Compare Retrieval Methods])
        UC5([ðŸ’¬ Get AI-Generated Answers])
        UC6([ðŸ“‹ View Source Citations])
        UC7([â­ Provide Feedback])
        UC8([ðŸ“„ Process New Documents])
        UC9([ðŸ•¸ï¸ Build Knowledge Graph])
        UC10([ðŸ“ˆ View System Statistics])
        UC11([ðŸ” Authenticate])
    end

    subgraph Actors["ðŸ‘¥ Actors"]
        User[("ðŸ‘¤ End User\n(Tax Professional)")]
        Admin[("ðŸ‘¨â€ðŸ’¼ Administrator")]
        DataEngineer[("ðŸ”§ Data Engineer")]
    end

    subgraph External["ðŸŒ External Systems"]
        Neo4j[(Neo4j AuraDB)]
        Gemini[Gemini LLM]
        LuatVN[LuatVietnam.vn]
    end

    %% User Use Cases
    User --> UC1
    User --> UC2
    User --> UC3
    User --> UC5
    User --> UC6
    User --> UC7
    User --> UC11

    %% Admin Use Cases
    Admin --> UC4
    Admin --> UC10
    Admin --> UC11

    %% Data Engineer Use Cases
    DataEngineer --> UC8
    DataEngineer --> UC9

    %% Include/Extend relationships
    UC1 -.->|includes| UC5
    UC5 -.->|includes| UC6
    UC1 -.->|extends| UC2
    UC1 -.->|extends| UC3
    UC8 -.->|includes| UC9

    %% External System Connections
    UC5 -.->|uses| Gemini
    UC3 -.->|uses| Neo4j
    UC8 -.->|crawls| LuatVN

    classDef usecase fill:#e0f2fe,stroke:#0284c7,color:#0c4a6e,rx:20,ry:20
    classDef actor fill:#f0fdf4,stroke:#16a34a,color:#166534
    classDef external fill:#fef3c7,stroke:#d97706,color:#92400e
    classDef system fill:#f8fafc,stroke:#64748b,color:#334155

    class UC1,UC2,UC3,UC4,UC5,UC6,UC7,UC8,UC9,UC10,UC11 usecase
    class User,Admin,DataEngineer actor
    class Neo4j,Gemini,LuatVN external
